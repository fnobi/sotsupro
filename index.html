<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><link rel="stylesheet" href="./stylesheets/style.css"><script type="text/javascript" src="./javascripts/jquery-1.8.2.js"></script><script type="text/javascript" src="./javascripts/html5.js"></script><script type="text/javascript" src="./javascripts/toc.js"></script><title>Webインタフェース構築のためのstate chart型言語</title></head><body><div id="wrap"><header id="header"><header>卒業論文 平成 24 年度(2012 年度)</header><h1>Webインタフェース構築のためのstate chart型言語</h1><footer>慶應義塾大学 環境情報学部<br>藤澤伸</footer></header><section id="abstruct"><h1>概要</h1>非同期処理を含むWebインタフェースを構築するための手法として、state chartを取り入れたヴィジュアルプログラミング環境を提案する。</section><section><h1>目次</h1><aside id="toc"></aside></section><article id="main"><section><h1>背景</h1><section><h1>Webアプリケーションの実装とAjax</h1><p>Webアプリケーションを制作する際、どのようなコンテンツを生成・提供するかを決めるサーバーサイド処理、ユーザーの挙動に対応して、コンテンツを操作したり、サーバーに新たなリクエストを送ったりするクライアントサイド処理の2種類のプログラムが考えられる。</p><p>このうちクライアントサイドでは、Ajaxという仕組みが使われることが、近年普通になってきている。Ajaxとは、Asynchronous JavaScript + XMLの略。Javascriptを通して、Webページ全体をを再読み込みすることなく、必要なデータだけをサーバーにリクエストすることができる。この特徴により、Ajaxを活用したWebアプリケーションでは、新しい情報を出す際にページの遷移がなくなり、ユーザーが読み込みを待つ時間が減り、サーバーにかかる負荷も押さえられる。</p></section><section><h1>同期処理と非同期処理</h1><p>Ajaxのもうひとつの特徴は、非同期処理という点だ。Javascriptを含む多くのプログラミング言語において、通常の進み方は同期処理と呼ばれ、ひとつの処理が終了するのを待って、次の処理に進む、という形をとっている。すなわち、プログラムのソースコードを上から下へ辿っていけば、実際に行われる処理を辿ることができる。</p><img><p>ところが、この途中にに非同期処理が入っていた場合、非同期処理の終了は待たれず、次の処理に進んでしまう。すなわち、この処理は元のプログラムとは別の流れで、並列に実行される。また、元のプログラムとは別に、この非同期処理が終わったあとに実行する処理を、「コールバック関数」として登録しておくことも多い。</p><p>Ajaxは、この非同期処理の形で、サーバーにリクエストを送り、取得したデータをコールバック関数を使って返す。これにより、例えばサイズの大きなファイルを、大量に読み込んだ場合でも、元のプログラムはとにかく先へ進み、読み込みが終わったものから順次画面上に表示する、ということもできる。</p><p>なおAjaxの他にも、画面上のボタンが押された時の処理、一定時間が経過してから実行する処理、なども非同期処理と呼ぶことができるだろう。</p></section><section><h1>HTML5の普及による影響</h1><p>現在のWebアプリケーション開発において、この非同期処理が担っている役割は大きい。HTML5の普及により、Webアプリケーションがよりリッチなインタフェースを持つようになったことが、その理由だ。これにより、スマートフォンへのマルチタッチや、本体を振るなど多種多様なイベントに対する振る舞いを取り扱う必要が出てきた。</p></section></section><section><h1>研究の目的</h1><section><h1>問題提起</h1><p>こうした流れの一方で、非同期処理は開発者にとっては分かりづらい部分も増やしている。例えば、関数がソースコード上で書かれている順番と、実行される順番が大きく異なる場合もある。かならず立て続けに実行される処理でも、ソースコード上では一続きに書くことができない、ということが起きる。</p><p>ソースコードの理解しづらさは、プログラムのメンテナンス性、また共同で開発をする場合の共有のしやすさ等の観点から、開発における障害となる。しかしながら、この読みづらいコードを取り扱わなければならないという問題に対して、いまのところ抜本的な解決策はない。</p><p>本研究では、こうしたWebインタフェースの非同期プログラミングにおける、メンテナンス性・共有性を改善する開発環境を提案する。</p></section><section><h1>解決方法</h1><p>本研究では、この問題を解決するためのヴィジュアルプログラミング環境を作成する。実行の位置が動的に変化する非同期処理を、上から下へと進むことしかできない、テキストのプログラミングで分かりやすく表現することには、限界があるからだ。</p><p>非同期処理がいくつもある形の処理は、いつどの処理が終わるのを待っているか、待ち状態の遷移の形で表現できると考えられるため、state chartを取り入れた表現方法を用いる。</p></section></section><section><h1>先行研究との比較</h1><section><h1>async.js, deffered.js</h1><p>ライブラリのレベルで、非同期処理をシンプルに書こうとする試みも、もちろんある。Javascriptのライブラリ「async.js」と「deffered.js」は、その中でも比較的よく知られているものだ。</p><blockquote><code><pre>async.series([
    function(callback){
        // do some stuff ...
        callback(null, 'one');
    },
    function(callback){
        // do some more stuff ...
        callback(null, 'two');
    },
],
// optional callback
function(err, results){
    // results is now equal to ['one', 'two']
});</pre></code></blockquote><em>async.jsを用いた非同期処理記述の例</em><p>ただし、いずれのライブラリも目的は、連続した非同期処理を、同期処理のように連続した形で書くことだ。すなわち、一続きになっている非同期処理を見やすい形で記述することは可能だが、コードのさまざまな場所で非同期処理が発生している場合の分かりづらさは、解決できない。</p></section><section><h1>Webアプリケーション構築のためのビジュアルプログラミング言語</h1><p>Webアプリケーションをビジュアルプログラミングで構築する試みは、以前にもあった。</p><p>ビジュアルプログラミング言語「ゆば」は、Webサービスを構築する際のハードルを下げるために開発され、データベースと連携した本格的なアプリケーションを、ビジュアル言語のみで記述できた。</p><img src="./img/yuba.jpg" alt="「ゆば」のエディター画面"><p>また、既にサービスとして運用されているものとしては「Yahoo! Pipes」がある。こちらは、サーバーサイドでのデータ整形に特化したプログラミング環境で、複数のAPIから情報を組み合わせて、新たなデータを生成することができる。</p><img src="./img/yahoopipes.gif" alt="「Yahoo! Pipes」によるプログラミング"><p>いずれの言語も、それぞれ異なった目的を持っている。本研究のように非同期処理をシンプルにするという目的、またWebインタフェースに特化したビジュアルプログラミング言語は未だないと言える。</p></section></section><section><h1>実装</h1><section><h1>システム仕様</h1><p>本研究では、Javascriptをベースにしたビジュアルプログラミング環境(以下、本システム)を実装した。本システムの開発は、Javascript(Node.jsによるサーバーサイド実装も含む)で行った。</p><img src="./img/Screen Shot 2013-01-20 at 19.01.19.png" alt="実際の画面"></section><section><h1>state chartの実装について</h1><p>本システムの骨子には、JavascriptによるStateMachine実装がある。</p></section><section><h1>基本的な使い方</h1><p>いくつかの状態を作り、それぞれ「この状况(condition)が起きたら、この状態に移動する」という形で、Webの挙動を記述できます。</p><p>また、それぞれの状况(condition)や状態遷移時に実行するアクションは、Javascriptで直接編集・追加ができます。(今回は実験のため、この機能は利用できません)</p><sugoroku>を使うことで、</sugoroku><ul><li>(1) Webの画面を開いてから、どんな時、ユーザーのどんな動作を待っているのか、それぞれの場合で何が起きるのか、一覧することができる。</li><li>(2) 一覧することにより、バグや処理の抜け落ちを防ぐことができる。</li><li>(3) フローチャートにも近いスタイルで、プログラムそのものを記述できる。そのため、どのような動作をするプログラムなのか、他の人にも伝えやすくなる。</li><li>(4) インタフェース構築を行う人と、Javascriptの機能そのものを書く人を分けることができる。</li></ul></section><section><h1>各部分の説明</h1><img src="./img/Screen Shot 2013-01-22 at 13.06.30.png"><h3>save</h3><p>このプログラムを保存します。</p><h3>new state</h3><p>状態を追加します。好きな名前を入力して、OKを押してください。</p><h3>オレンジ色の四角 => 状態(state)</h3><p>あるひとつの状態を表しています。色の濃いものは初期状態(initial)、Webの画面を開いた時点での状態です。</p><ul><li>→<strong>ドラッグ&ドロップ</strong>...画面上での位置を動かします。</li><li>→<strong>クリック</strong>...選択。右のバーにその状態の情報が表示されます。</li><li>→<strong>状態名の左の●をクリック</strong>...そのまま、別の状態の●をクリックすると、そこまで矢印をひきます。(=状態遷移する条件を追加)<br>すぐに右のバーからconditionを指定しましょう。</li></ul><h3>矢印 => 状態遷移(transition)</h3><p>ある状態からある状態へ、どんな場合に移動するかを指定しています。</p><ul><li>→<strong>クリック</strong>...選択。右のバーにその状態の情報が表示されます。</li></ul></section></section><section><h1>考察</h1><section><h1>目的の再確認</h1><p>本研究の目的は、Webインタフェースの非同期プログラミングにおける、メンテナンス性・共有性を改善する、ツールを提案することである。この章では、今回開発したヴィジュアルプログラミング環境「sugoroku」が、プログラムのメンテナンス性・共有性を向上させることができるかどうかを評価する。</p></section><section><h1>実験</h1><p>まず本システムを使って、簡単なSNS風Webアプリケーションを作成した。被験者には、このアプリケーションを、いくつかの設問に応じて変更する、という作業を行ってもらった。</p><!-- p 設問は以下の通り--><p>またこれとは別に、アンケートで以下の項目について回答してもらった。</p><ul><li>プログラミングの経験</li><li>Javascriptプログラミングの経験</li><li>sugorokuの操作は分かりやすかったか(5段階)</li></ul></section><!-- section--><!--   h1 実験結果--></section><section><h1>結論</h1><p>本システムを用いることで、Webアプリケーションの非同期処理を、分かりやすく表現・記述することができる。</p></section><!-- section--><!--   h1 謝辞--><section><h1>参考文献</h1><ul><li><a href="http://adaptivepath.com/ideas/ajax-new-approach-web-applications">Ajax: A New Approach to Web Applications - Adaptive Path</a></li><li><a href="http://harp.lib.hiroshima-u.ac.jp/handle/harp/8385">HARP: Ajaxの非同期通信を利用したWebチラシの自動更新およびポータルシステムの構築</a></li><li><a href="http://github.com/caolan/async">caolan/async · GitHub</a></li><li><a href="http://cho45.stfuawsc.com/jsdeferred/">JSDeferred - Asynchronous library in JavaScript. Standalone and Compact</a></li><li><a href="http://bizboard.nikkeibp.co.jp/houjin/cgi-bin/nsearch/md_pdf.pl/0000224168.pdf?NEWS_ID=0000224168&amp;CONTENTS=1&amp;bt=NCC&amp;SYSTEM_ID=HO">企業を熱くする最新テクノロジ Ajax 非同期通信でネット負荷を軽減 ブラウザ操作向上で業務効率改善</a></li><li>三浦琢磨「ウェブサイト構築を目的とした データフロー型ビジュアルプログラミング言語 『ゆば』の開発」、『2007年度早稲田大学修士論文集』、2008</li><li>小澤正樹「GUIの絵コンテ式ビジュアルプログラミング」、『情報処理学会研究報告. ソフトウェア工学研究会報告 94(18)』、17-24、1994-03-01</li><li>G. COSTAGLIOLA, A. DELUCIA, S. OREFICEz AND G. POLESE「A Classification Framework to Support the Design of Visual Languages」, Journal of Visual Languages and Computing, 13, 2002, p.573-600</li></ul></section><section><h1>付録</h1><dl><dt>本論文URL</dt><dd><a href="http://sotsupro.fnobi.com/">http://sotsupro.fnobi.com/</a></dd></dl><dl><dt>本システムソースコード</dt><dd><a href="http://github.com/fnobi/sugoroku">http://github.com/fnobi/sugoroku</a></dd></dl><dl><dt>本システムデモページ</dt><dd><a href="http://sugoroku.fnobi.com">http://sugoroku.fnobi.com</a></dd></dl></section></article></div></body></html>